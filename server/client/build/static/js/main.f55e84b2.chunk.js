(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,a){e.exports=a(92)},32:function(e,t,a){},34:function(e,t,a){},82:function(e,t,a){},84:function(e,t,a){},86:function(e,t,a){},88:function(e,t,a){},90:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(26),o=a.n(c),r=(a(32),a(3)),i=a(5),l=a(6),u=a(8),m=a(7),d=a(9),h=a(1),f=(a(34),a(10)),p=a(11),g=a.n(p),b="pk.eyJ1Ijoic2FzY2hhbXoiLCJhIjoiY2pueWE3NGN0MGR0YjNwbzV3Zm5udjFkZiJ9.Yhe8XyJjVRuDsBHs9SsBMw",v="dEOco1PlZlmshIPqrt4ycn7xZE9zp1Mscwbjsnu53Bztt9kFJ2",y=a(15),k=a.n(y),O=(a(82),a(84),function(e){var t=e.position,a=t.x,n=t.y;return s.a.createElement("div",{className:"spinner-container",style:{transform:"translate(".concat(a-30,"px, ").concat(n-30,"px)")}},s.a.createElement("div",{className:"lds-dual-ring"}))}),j=(a(86),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={range:125},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.toggleLocal,n=t.setRange,c=t.toggled,o=t.openModal,r=c?"Local":"Global";return s.a.createElement("div",{className:"toggle"},s.a.createElement("div",{className:"btn-info",onClick:function(){return o()}},s.a.createElement("i",{className:"fas fa-info-circle info"})),s.a.createElement("div",{className:"settings-container"},c&&s.a.createElement("div",{className:"range-container"},s.a.createElement("label",{className:"label",htmlFor:"range-slider"},this.state.range," km"),s.a.createElement("input",{className:"range-slider",id:"range-slider",type:"range",min:"1",max:"250",defaultValue:"125",onChange:function(t){return e.setState({range:t.target.value})},onMouseUp:function(e){return n(e.target.value)}})),s.a.createElement("label",{className:"label",htmlFor:"myonoffswitch"},r),s.a.createElement("div",{className:"onoffswitch"},s.a.createElement("input",{type:"checkbox",className:"onoffswitch-checkbox",name:"onoffswitch",onClick:function(e){return a(e.target.checked)},id:"myonoffswitch"}),s.a.createElement("label",{className:"onoffswitch-label",htmlFor:"myonoffswitch"},s.a.createElement("span",{className:"onoffswitch-inner"}),s.a.createElement("span",{className:"onoffswitch-switch"})))))}}]),t}(n.Component)),w=g()({accessToken:b}),E=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={markers:[],countryOffsets:{},settings:{searchMethod:"global",range:125},spinner:{loading:!1,position:{x:null,y:null}}},a.handleClick=a.handleClick.bind(Object(h.a)(Object(h.a)(a))),a.toggleLocal=a.toggleLocal.bind(Object(h.a)(Object(h.a)(a))),a.setRange=a.setRange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getCameras=k.a.create({method:"GET",baseURL:"https://webcamstravel.p.mashape.com/webcams/list/",headers:{"X-Mashape-Key":v,"X-Mashape-Host":"webcamstravel.p.mashape.com"}})}},{key:"getOffsets",value:function(e){var t=this.state.countryOffsets;return t[e]||(t[e]=0),t}},{key:"requestWebcams",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=this.getOffsets(e);this.getCameras("limit=".concat(a,",").concat(n[e],"/country=").concat(e,"&show=webcams:player,location")).then(function(a){n[e]+=50;var s=a.data.result.webcams,c=t.spinnerObject(!1);t.setState(function(e){return Object(r.a)({},e,{markers:Object(f.a)(e.markers).concat(Object(f.a)(s)),countryOffsets:n,spinner:c})})})}},{key:"spinnerObject",value:function(e,t,a){var n=this.state.spinner;return n.loading=e,t&&(n.position.x=t),a&&(n.position.y=a),n}},{key:"animateOverlay",value:function(e){var t=e.x,a=e.y,n=this.refs.mapContainer;n.classList.add("overlay");var s=this.spinnerObject(!0,t,a);this.setState(function(e){return Object(r.a)({},e,{spinner:s})}),setTimeout(function(){return n.classList.remove("overlay")},400)}},{key:"handleClick",value:function(e,t){var a=this,n=t.lngLat,s=n.lng,c=n.lat,o=t.point,i=o.x,l=o.y,u=this.state.settings,m=u.searchMethod,d=u.range;this.animateOverlay({x:i,y:l}),"global"===m?k.a.get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(s,",").concat(c,".json?access_token=").concat(b,"&country")).then(function(e){if(e.data.features.length>0){var t=e.data.features.filter(function(e){return e.id.match(/country/)})[0].properties.short_code;a.requestWebcams(t)}else{var n=a.spinnerObject(!1);a.setState(function(e){return Object(r.a)({},e,{spinner:n})})}}):this.getCameras("nearby=".concat(c,",").concat(s,",").concat(d,"&show=webcams:player,location")).then(function(e){var t=e.data.result.webcams,n=a.spinnerObject(!1);a.setState(function(e){return Object(r.a)({},e,{markers:Object(f.a)(e.markers).concat(Object(f.a)(t)),spinner:n})})})}},{key:"renderMarker",value:function(e){var t=this,a=e.location,n=e.player,c=n.live.embed||n.day.embed,o=a.longitude,r=a.latitude,i=a.city,l=a.country;return s.a.createElement(p.Feature,{onClick:function(){return t.props.updateFeed({src:c,city:i,country:l})},coordinates:[o,r],key:o+r})}},{key:"toggleLocal",value:function(e){var t=this.state.settings;t.searchMethod=e?"local":"global",this.setState(function(e){return Object(r.a)({},e,{settings:t})})}},{key:"setRange",value:function(e){var t=this.state.settings;t.range=e,this.setState(function(e){return Object(r.a)({},e,{settings:t})})}},{key:"render",value:function(){var e=this,t=this.state.markers,a=this.state.spinner.loading,n=this.props.openModal,c="local"===this.state.settings.searchMethod;return s.a.createElement("div",null,a&&s.a.createElement(O,{position:this.state.spinner.position}),s.a.createElement(j,{toggleLocal:this.toggleLocal,setRange:this.setRange,openModal:n,toggled:c}),s.a.createElement("div",{className:"map-container",ref:"mapContainer"},s.a.createElement(w,{style:"mapbox://styles/mapbox/streets-v8",className:"map",onContextMenu:this.handleClick},s.a.createElement(p.Layer,{type:"symbol",id:"marker",layout:{"icon-image":"marker-15"}},t.map(function(t){return e.renderMarker(t)})))))}}]),t}(n.Component),N=(a(88),function(e){var t=e.data,a=t.src,n=t.country,c=t.city;return s.a.createElement("div",{className:"feed"},s.a.createElement("h1",null,n,", ",c),s.a.createElement("iframe",{title:"feed",src:a+"?autoplay=1"}))}),M=(a(90),function(e){return s.a.createElement("div",{className:"modal-container"},s.a.createElement("div",{className:"modal"},s.a.createElement("h1",null,"Worldlapse"),s.a.createElement("div",{className:"rows"},s.a.createElement("div",{className:"row"},s.a.createElement("i",{className:"fas fa-hand-point-up"}),"Rightclick anywhere to search for live feeds/timelapses from that country."),s.a.createElement("div",{className:"row"},s.a.createElement("i",{className:"fas fa-sliders-h"}),"Use the toggle and slider in the bottom left corner to instead search within a 1-250 kilometer radius."),s.a.createElement("div",{className:"row"},s.a.createElement("i",{className:"fas fa-hand-point-up"}),"Keep rightclicking if you want to load more feeds."),s.a.createElement("div",{className:"row"},s.a.createElement("i",{className:"fas fa-video"}),"When you're ready, leftclick on one of the markers to see what's going on.")),s.a.createElement("button",{onClick:e.closeModal},"Got it!")))}),C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={renderFeed:!1,feedData:null,showModal:!1},a.updateFeed=a.updateFeed.bind(Object(h.a)(Object(h.a)(a))),a.toggleModal=a.toggleModal.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("modal")||(this.setState(function(e){return Object(r.a)({},e,{showModal:!0})}),localStorage.setItem("modal","seen"))}},{key:"updateFeed",value:function(e){var t=e.src,a=e.city,n=e.country;this.setState(function(e){return Object(r.a)({},e,{renderFeed:!0,feedData:{src:t,city:a,country:n}})})}},{key:"toggleModal",value:function(){this.setState(function(e){return Object(r.a)({},e,{showModal:!e.showModal})})}},{key:"render",value:function(){var e=this.state,t=e.renderFeed,a=e.feedData,n=e.showModal;return s.a.createElement("div",{className:"App"},n&&s.a.createElement(M,{closeModal:this.toggleModal}),t&&s.a.createElement(N,{data:a}),s.a.createElement(E,{updateFeed:this.updateFeed,openModal:this.toggleModal}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,2,1]]]);
//# sourceMappingURL=main.f55e84b2.chunk.js.map